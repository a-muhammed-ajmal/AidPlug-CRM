import{c as v,a as b,d as w,b as P,r as t,j as e,U as S,X as C}from"./index-NvUe1ZN8.js";import{u as k}from"./useUserProfile-BbtWJfP5.js";import{P as E}from"./PasswordStrengthIndicator-CuMA_Um-.js";import{S as d}from"./SkeletonLoader-DxXA5r8T.js";import{P as U}from"./pen-line-Dgv-gfwV.js";import{K as L}from"./key-round-BBzQ7HMs.js";import{E as O,a as A}from"./eye-CNI_WSyx.js";import"./userService-B1WNrPKI.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=v("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),I=({onClose:s})=>{const{updateUserPassword:i}=b(),{addNotification:o}=w(),[a,c]=t.useState(""),[r,m]=t.useState(""),[l,x]=t.useState(!1),[h,f]=t.useState(!1),[j,u]=t.useState(""),[g,N]=t.useState(!1),y=async n=>{if(n.preventDefault(),u(""),a!==r){u("Passwords do not match.");return}f(!0);try{await i(a),o("Success","Your password has been updated."),s()}catch(p){u(p instanceof Error?p.message:"Failed to update password.")}finally{f(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex justify-center items-end sm:items-center animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-t-2xl sm:rounded-xl shadow-xl animate-slide-up",children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h1",{className:"text-lg font-bold",children:"Change Password"}),e.jsx("button",{onClick:s,className:"p-2 -mr-2 rounded-full hover:bg-gray-100",children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("main",{className:"p-6 space-y-4",children:[j&&e.jsx("p",{className:"text-red-500 text-sm bg-red-50 p-3 rounded-md",children:j}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"New Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{type:l?"text":"password",value:a,onChange:n=>c(n.target.value),className:"w-full p-2 pr-10 border rounded-md",required:!0}),e.jsx("button",{type:"button",onClick:()=>x(!l),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500",children:l?e.jsx(O,{size:18}):e.jsx(A,{size:18})})]}),e.jsx(E,{password:a,onValidationChange:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:r,onChange:n=>m(n.target.value),className:"w-full mt-1 p-2 border rounded-md",required:!0})]})]}),e.jsx("footer",{className:"p-4 bg-gray-50 border-t",children:e.jsx("button",{type:"submit",disabled:h||!g||a!==r,className:"w-full py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50",children:h?"Updating...":"Update Password"})})]})]})})};function D(){const{profile:s,isLoading:i,error:o}=k(),{signOut:a}=b(),{showConfirmation:c}=w(),r=P(),[m,l]=t.useState(!1),x=()=>{c("Sign Out","Are you sure you want to sign out?",()=>{a(),r("/")})};return o?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl",children:[e.jsx("p",{className:"font-semibold",children:"Error Loading Profile"}),e.jsx("p",{className:"text-sm mt-1",children:o instanceof Error?o.message:"Unable to load your account information."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-3 text-sm font-medium text-red-600 hover:underline",children:"Try Again"})]})}):i?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex items-center space-x-4",children:[e.jsx(d,{className:"w-20 h-20 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(d,{className:"h-6 w-3/4"}),e.jsx(d,{className:"h-4 w-1/2"}),e.jsx(d,{className:"h-4 w-1/4"})]})]}),e.jsx(d,{className:"h-24 rounded-xl"}),e.jsx(d,{className:"h-14 rounded-lg"})]}):s?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center overflow-hidden flex-shrink-0",children:s!=null&&s.photo_url?e.jsx("img",{src:s.photo_url,alt:"User",className:"w-full h-full object-cover"}):e.jsx(S,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:(s==null?void 0:s.full_name)||"User"}),e.jsx("p",{className:"text-sm text-gray-600",children:(s==null?void 0:s.designation)||"N/A"}),e.jsxs("button",{onClick:()=>r("/account/edit"),className:"mt-2 text-sm font-medium text-blue-600 hover:underline flex items-center",children:[e.jsx(U,{className:"w-3 h-3 mr-1"})," Edit Profile"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Security"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Password"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Change your password regularly"})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>l(!0),className:"text-sm font-medium text-blue-600 hover:underline",children:"Change"})})]})})]}),e.jsx("div",{className:"pt-2",children:e.jsxs("button",{onClick:x,className:"w-full flex items-center justify-center py-3 px-4 bg-white border border-gray-200 text-red-600 rounded-lg font-semibold hover:bg-red-50 transition-colors shadow-sm",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),"Sign Out"]})}),m&&e.jsx(I,{onClose:()=>l(!1)})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 p-4 rounded-xl",children:[e.jsx("p",{className:"font-semibold",children:"Profile Not Found"}),e.jsx("p",{className:"text-sm mt-1",children:"Your profile information could not be loaded. Please try refreshing the page."})]})})}export{D as default};
