import{c as G,i as R,e as V,a as Z,d as W,r as x,E as O,j as e,X as q,k as D,l as ee,P as se,R as le,m as ae,B as re,n as te,u as ne,h as oe}from"./index-NvUe1ZN8.js";import{E as de}from"./EmptyState-DD9JB5rK.js";import{S as v}from"./SkeletonLoader-DxXA5r8T.js";import{I as ce}from"./info-DOZ6-6U3.js";import{C as H}from"./chevron-down-BbxtYO4C.js";import{D as me,a as T}from"./DropdownMenu--EYT8ldO.js";import{P as ie,S as ue}from"./search-CeK9lVvl.js";import{M as xe}from"./mail-BRfvtj-5.js";import{P as he}from"./plus-DOf-Dc6j.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=G("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),F=({title:l,children:s})=>e.jsxs("div",{className:"md:col-span-2 mt-4 first:mt-0",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800 border-b pb-2 mb-4",children:l}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:s})]}),u=({label:l,children:s,required:m,className:c})=>e.jsxs("div",{className:c,children:[e.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[l,m&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s]}),I=({id:l,name:s,value:m,onChange:c,options:b,required:h,placeholder:i})=>e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:l,name:s,value:m,onChange:c,required:h,className:"w-full appearance-none bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-3 pr-10",children:[e.jsx("option",{value:"",disabled:!0,children:i||"Select..."}),b.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx(H,{className:"w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"})]}),k=({label:l,checked:s,onChange:m})=>e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:l}),e.jsx("div",{className:`relative w-11 h-6 rounded-full transition-colors ${s?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform ${s?"translate-x-5":"translate-x-0"}`})}),e.jsx("input",{type:"checkbox",checked:s,onChange:c=>m(c.target.checked),className:"hidden"})]});function ge({onClose:l,initialData:s}){var L,E,w,M;const{createLead:m,updateLead:c,deleteLead:b}=R(),{createDeal:h}=V(),{user:i}=Z(),{addNotification:t,showConfirmation:d}=W(),[j,f]=x.useState(!1),_=s?"edit":"add",[a,y]=x.useState({full_name:(s==null?void 0:s.full_name)||"",company_name:(s==null?void 0:s.company_name)||"",phone:((L=s==null?void 0:s.phone)==null?void 0:L.replace("+971","").trim())||"",email:(s==null?void 0:s.email)||"",location:(s==null?void 0:s.location)||"Dubai",bank_name:(s==null?void 0:s.bank_name)||"Emirates Islamic Bank",product_type:(s==null?void 0:s.product_type)||"Credit Card",product:(s==null?void 0:s.product)||"RTA Credit Card",monthly_salary:((E=s==null?void 0:s.monthly_salary)==null?void 0:E.toString())||"",salary_variations:(s==null?void 0:s.salary_variations)||!1,existing_cards:(s==null?void 0:s.existing_cards)||!1,cards_duration:(s==null?void 0:s.cards_duration)||"",total_credit_limit:((w=s==null?void 0:s.total_credit_limit)==null?void 0:w.toString())||"",has_emi:(s==null?void 0:s.has_emi)||!1,emi_amount:((M=s==null?void 0:s.emi_amount)==null?void 0:M.toString())||"",applied_recently:(s==null?void 0:s.applied_recently)||!1,documents_available:(s==null?void 0:s.documents_available)||[],create_task:!1}),[N,A]=x.useState(O.map(r=>r.name));x.useEffect(()=>{let r=[];a.bank_name==="Emirates Islamic Bank"&&a.product_type==="Credit Card"?r=O.map(o=>o.name):a.product_type==="Account Opening"&&(r=["Personal Account","Business Account"]),A(r),y(o=>({...o,product:r.includes(o.product)?o.product:r[0]||""}))},[a.bank_name,a.product_type]);const p=r=>{const{name:o,value:n}=r.target;y(C=>({...C,[o]:n}))},g=(r,o)=>{y(n=>({...n,[r]:o}))},P=r=>{y(o=>{const n=o.documents_available.includes(r)?o.documents_available.filter(C=>C!==r):[...o.documents_available,r];return{...o,documents_available:n}})},S=async r=>{if(r.preventDefault(),!i){t("Authentication Error","You must be logged in.");return}f(!0);const o={full_name:a.full_name,phone:`+971 ${a.phone}`,company_name:a.company_name,email:a.email||null,loan_amount_requested:0,stage:(s==null?void 0:s.stage)||"warm",location:a.location,bank_name:a.bank_name,product_type:a.product_type,product:a.product,monthly_salary:parseInt(a.monthly_salary,10)||null,salary_months:null,salary_variations:a.salary_variations,existing_cards:a.existing_cards,cards_duration:a.existing_cards?a.cards_duration:null,total_credit_limit:a.existing_cards&&parseInt(a.total_credit_limit,10)||null,has_emi:a.has_emi,emi_amount:a.has_emi&&parseInt(a.emi_amount,10)||null,applied_recently:a.applied_recently,documents_available:a.documents_available,employment_years:null,existing_loans:null,user_id:i.id};_==="add"?m.mutate(o,{onSuccess:()=>{t("Lead Created",`${a.full_name} has been saved.`),l()},onError:n=>{t("Error",n.message)},onSettled:()=>f(!1)}):c.mutate({id:s.id,updates:o},{onSuccess:()=>{t("Lead Updated",`${a.full_name} has been saved.`),l()},onError:n=>{t("Error",n.message)},onSettled:()=>f(!1)})},$=["Emirates ID Original","Passport Clear Photo","Salary Certificate (for listed companies) or Labor Contract / Offer Letter (for freezone companies)","Payslips (Last 3 months for listed companies, or 1 payslip for freezone companies)"];return e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex justify-center items-end animate-fade-in sm:items-center",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-t-2xl sm:rounded-2xl shadow-xl transform transition-transform animate-slide-up flex flex-col max-h-[90vh]",children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:_==="add"?"Add New Lead":"Edit Lead"}),e.jsx("button",{onClick:l,className:"p-2 -mr-2 rounded-full hover:bg-gray-100",children:e.jsx(q,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("form",{onSubmit:S,className:"flex-1 flex flex-col min-h-0",children:[e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6",children:[e.jsx(F,{title:"Personal & Product Info",children:e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Full Name",children:e.jsx("input",{type:"text",name:"full_name",value:a.full_name,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg"})}),e.jsx(u,{label:"Company Name",children:e.jsx("input",{type:"text",name:"company_name",value:a.company_name,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg"})}),e.jsx(u,{label:"Mobile Number",children:e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 bg-gray-200 border rounded-l-lg",children:"+971"}),e.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:r=>{let o=r.target.value.replace(/\D/g,"");o.startsWith("971")?o=o.slice(3):o.startsWith("0")&&o.length===10&&(o=o.slice(1)),o.length>9&&(o=o.slice(0,9)),y(n=>({...n,phone:o}))},className:"w-full bg-gray-50 border p-3 rounded-r-lg",placeholder:"50 123 4567"})]})}),e.jsx(u,{label:"Email Address",children:e.jsx("input",{type:"email",name:"email",value:a.email,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg"})}),e.jsx(u,{label:"Location",children:e.jsx(I,{id:"location",name:"location",value:a.location,onChange:p,options:D})}),e.jsx(u,{label:"Bank Applying",children:e.jsx(I,{id:"bank_name",name:"bank_name",value:a.bank_name,onChange:p,options:ee})}),e.jsx(u,{label:"Product Type",children:e.jsx(I,{id:"product_type",name:"product_type",value:a.product_type,onChange:p,options:se})}),N.length>0&&e.jsx(u,{label:"Product",children:e.jsx(I,{id:"product",name:"product",value:a.product,onChange:p,options:N})})]})}),e.jsx(F,{title:"Salary Information",children:e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Monthly Salary (AED)",children:e.jsx("input",{type:"number",name:"monthly_salary",value:a.monthly_salary,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg"})}),e.jsx(u,{className:"md:col-span-2",label:"",children:e.jsx(k,{label:"Any variations in salary during the last 3 months?",checked:a.salary_variations,onChange:r=>g("salary_variations",r)})}),a.salary_variations&&e.jsxs("div",{className:"md:col-span-2 -mt-2 text-xs text-blue-700 bg-blue-50 p-2 rounded-md flex items-center",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"})," Please provide last three months payslips to confirm the reason for variations."]})]})}),e.jsx(F,{title:"Credit History",children:e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"md:col-span-2",label:"",children:e.jsx(k,{label:"Are you currently using any credit cards?",checked:a.existing_cards,onChange:r=>g("existing_cards",r)})}),a.existing_cards&&e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Using cards since?",children:e.jsx("input",{type:"text",name:"cards_duration",value:a.cards_duration,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg",placeholder:"e.g., 2 years"})}),e.jsx(u,{label:"Total credit limit of cards",children:e.jsx("input",{type:"number",name:"total_credit_limit",value:a.total_credit_limit,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg"})})]}),e.jsx(u,{className:"md:col-span-2",label:"",children:e.jsx(k,{label:"Are you currently paying any EMI for any type of loan (personal, business, auto, housing, etc.)?",checked:a.has_emi,onChange:r=>g("has_emi",r)})}),a.has_emi&&e.jsx(u,{label:"Total EMI Amount (AED)",children:e.jsx("input",{type:"number",name:"emi_amount",value:a.emi_amount,onChange:p,className:"w-full bg-gray-50 border p-3 rounded-lg"})})]})}),e.jsx(F,{title:"Application & Documents",children:e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"md:col-span-2",label:"",children:e.jsx(k,{label:"Have you applied for the same bank/product within the last 60 days?",checked:a.applied_recently,onChange:r=>g("applied_recently",r)})}),e.jsx(u,{className:"md:col-span-2",label:"",children:e.jsx(k,{label:"Create a Task",checked:a.create_task||!1,onChange:r=>g("create_task",r)})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Documents Available"}),e.jsx("div",{className:"space-y-2",children:$.map(r=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.documents_available.includes(r),onChange:()=>P(r),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm",children:r})]},r))})]})]})})]})}),e.jsx("footer",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex space-x-3",children:[_==="edit"&&e.jsx("button",{type:"button",onClick:()=>{s&&d("Delete Lead",`Are you sure you want to delete "${s.full_name}"? This action cannot be undone.`,()=>{b.mutate(s.id,{onSuccess:()=>{t("Lead Deleted",`${s.full_name} has been deleted.`),l()},onError:r=>{t("Error",r.message)}})})},className:"flex-1 py-3 px-4 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-all active:scale-95 shadow",children:"Delete Lead"}),e.jsx("button",{type:"button",onClick:()=>{var r;if(s){const o={title:`${s.product||"Deal"} - ${s.full_name}`,amount:s.loan_amount_requested||(s.monthly_salary||0)*3||5e4,stage:"application_processing",client_name:s.full_name,expected_close_date:new Date(Date.now()+2592e6).toISOString().split("T")[0],probability:25,product_type:(r=s.product)==null?void 0:r.toLowerCase().replace(/ /g,"_"),user_id:i.id,application_number:`APP-${Math.floor(1e4+Math.random()*9e4)}`,bdi_number:`BDI-${Math.floor(1e4+Math.random()*9e4)}`};h.mutate(o,{onSuccess:()=>{t("Lead Converted",`${s.full_name} is now a deal.`),b.mutate(s.id),l()},onError:n=>t("Conversion Failed",n.message)})}},className:"flex-1 py-3 px-4 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all active:scale-95 shadow",children:"Convert to Deal"}),e.jsx("button",{type:"submit",disabled:j,className:"flex-1 py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all active:scale-95 shadow disabled:opacity-50",children:j?"Saving...":_==="add"?"Save Lead":"Update Lead"})]})})]})]})})}const be=l=>l?l.split(" ").map(s=>s[0]).slice(0,2).join("").toUpperCase():"?",fe=({name:l})=>{const s=be(l),m=h=>{let i=0;for(let t=0;t<h.length;t++)i=h.charCodeAt(t)+((i<<5)-i);return i},c=["bg-blue-100 text-blue-800","bg-purple-100 text-purple-800","bg-green-100 text-green-800","bg-yellow-100 text-yellow-800","bg-red-100 text-red-800","bg-indigo-100 text-indigo-800"],b=c[Math.abs(m(l))%c.length];return e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm ${b} flex-shrink-0`,children:s})},ye=l=>{switch(l){case"warm":return"bg-yellow-100 text-yellow-800";case"qualified":return"bg-blue-100 text-blue-800";case"appointment_booked":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},z=l=>{switch(l){case"warm":return"Warm";case"qualified":return"Qualified";case"appointment_booked":return"Appointment";default:return"Not Set"}},je=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99 0-3.903-.52-5.586-1.456l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.269.654 4.495 1.932 6.22l-1.023 3.744 3.845-1.004zm-3.837 1.387l.494.296c1.695 1.011 3.58 1.574 5.63 1.576 6.245 0 11.33-5.084 11.332-11.33.001-6.247-5.085-11.332-11.334-11.332-6.245 0-11.331 5.085-11.333 11.331.001 2.431.792 4.78 2.215 6.64l.43.586-1.24 4.545 4.66-1.219z"})}),_e=le.memo(({lead:l,onEdit:s})=>{const{updateLead:m}=R(),c=(d,j)=>{d.stopPropagation(),j()},b=d=>{m.mutate({id:l.id,updates:{stage:d}})},h=()=>{l.phone&&(window.location.href=`tel:${l.phone.replace(/\s/g,"")}`)},i=()=>{l.email&&(window.location.href=`mailto:${l.email}`)},t=()=>{if(l.phone){const d=l.phone.replace(/[^0-9]/g,"");window.open(`https://wa.me/${d}`,"_blank")}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 border border-gray-200 hover:shadow-md hover:-translate-y-0.5 transition-all duration-200 active:scale-98",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx(fe,{name:l.full_name}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-gray-900 truncate",title:l.full_name,children:l.full_name}),e.jsx("p",{className:"text-xs text-gray-500 truncate",title:l.company_name||"N/A",children:l.company_name||"No Company"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 md:space-x-2",children:[e.jsxs(me,{trigger:e.jsxs("button",{className:`px-1.5 py-0.5 md:px-2 md:py-1 text-xs font-medium rounded-full flex items-center space-x-1 ${ye(l.stage)}`,children:[e.jsx("span",{className:"hidden sm:inline",children:z(l.stage)}),e.jsx("span",{className:"sm:hidden",children:z(l.stage).charAt(0)}),e.jsx(H,{className:"w-3 h-3"})]}),placement:"bottom-end",children:[e.jsx(T,{onClick:()=>b("warm"),children:"Warm"}),e.jsx(T,{onClick:()=>b("qualified"),children:"Qualified"}),e.jsx(T,{onClick:()=>b("appointment_booked"),children:"Appointment"})]}),e.jsx("button",{onClick:d=>c(d,()=>s(l)),className:"p-1 -mr-1 rounded-full hover:bg-gray-100",children:e.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700 my-3 border-t border-gray-100 pt-3",children:[e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(ae,{className:"w-3.5 h-3.5 mr-2 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",title:l.bank_name||"",children:l.bank_name||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(re,{className:"w-3.5 h-3.5 mr-2 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",title:l.product||"",children:l.product||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("button",{onClick:d=>c(d,h),disabled:!l.phone,className:"flex items-center justify-center py-2 px-1 md:px-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-xs font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ie,{className:"w-3.5 h-3.5 mr-1 md:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Call"})]}),e.jsxs("button",{onClick:d=>c(d,t),disabled:!l.phone,className:"flex items-center justify-center py-2 px-1 md:px-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-xs font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(je,{}),e.jsx("span",{className:"ml-1 md:ml-1.5 hidden sm:inline",children:"WhatsApp"})]}),e.jsxs("button",{onClick:d=>c(d,i),disabled:!l.email,className:"flex items-center justify-center py-2 px-1 md:px-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-xs font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(xe,{className:"w-3.5 h-3.5 mr-1 md:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Email"})]})]})]})});function Ne({isOpen:l,onClose:s,filters:m,setFilters:c,onApply:b,onClear:h}){if(!l)return null;const i=t=>{const{value:d,checked:j}=t.target;c(f=>{const _=j?[...f.products,d]:f.products.filter(a=>a!==d);return{...f,products:_}})};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex justify-center items-end animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-t-2xl shadow-xl p-6 transform transition-transform animate-slide-up",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Filter Leads"}),e.jsx("button",{onClick:s,className:"p-2 -mr-2 rounded-full hover:bg-gray-100",children:e.jsx(q,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("div",{className:"space-y-6 overflow-y-auto max-h-[60vh] pr-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Urgency"}),e.jsx("div",{className:"flex space-x-2 bg-gray-100 p-1 rounded-lg mt-2",children:["all","high","medium","low"].map(t=>e.jsx("button",{onClick:()=>c(d=>({...d,urgency:t})),className:`flex-1 py-2 px-3 text-xs font-medium rounded-md transition-all ${m.urgency===t?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"salary",className:"text-sm font-medium text-gray-700 flex justify-between",children:[e.jsx("span",{children:"Minimum Monthly Salary (AED)"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[(m.salaryRange[0]/1e3).toFixed(0),"K"]})]}),e.jsx("input",{id:"salary",type:"range",min:"0",max:"100000",step:"5000",value:m.salaryRange[0],onChange:t=>c(d=>({...d,salaryRange:[parseInt(t.target.value),1e5]})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mt-2 accent-blue-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Product Interest"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:te.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",value:t.key,checked:m.products.includes(t.key),onChange:i,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-800 capitalize",children:t.name})]},t.key))})]})]}),e.jsxs("div",{className:"mt-8 flex space-x-3",children:[e.jsx("button",{onClick:h,className:"flex-1 py-3 px-4 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-all active:scale-95",children:"Clear All"}),e.jsx("button",{onClick:b,className:"flex-1 py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all active:scale-95 shadow",children:"Apply Filters"})]})]})})}function Fe(){var o;const{setTitle:l}=W();x.useEffect(()=>{l("Leads")},[l]);const s=ne(),{leads:m,isLoading:c}=R(),[b,h]=x.useState(((o=s.state)==null?void 0:o.showAddModal)||!1),[i,t]=x.useState(null),[d,j]=x.useState(""),[f,_]=x.useState("all"),[a,y]=x.useState(!1),N=x.useMemo(()=>({urgency:"all",salaryRange:[0,1e5],products:[]}),[]),[A,p]=x.useState(N),[g,P]=x.useState(N),S=x.useMemo(()=>JSON.stringify(g)!==JSON.stringify(N),[g,N]);x.useEffect(()=>{var n;(n=s.state)!=null&&n.showAddModal&&h(!0)},[s.state]);const $=()=>{p(g),y(!0)},L=()=>{P(A),y(!1)},E=()=>{p(N)},w=x.useMemo(()=>m?m.filter(n=>{var B;const C=d===""||n.full_name.toLowerCase().includes(d.toLowerCase())||((B=n.company_name)==null?void 0:B.toLowerCase().includes(d.toLowerCase()))||n.phone.includes(d),Q=f==="all"||n.stage===f,J=g.urgency==="all"||n.urgency_level===g.urgency,K=(n.monthly_salary||0)>=g.salaryRange[0],Y=g.products.length===0||g.products.some(X=>{var U;return(U=n.product_interest)==null?void 0:U.includes(X)});return C&&Q&&J&&K&&Y}):[],[d,f,g,m]);if(c)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:[e.jsx(v,{className:"h-10 w-full"}),e.jsxs("div",{className:"flex space-x-1 mt-4",children:[e.jsx(v,{className:"h-10 flex-1"}),e.jsx(v,{className:"h-10 flex-1"}),e.jsx(v,{className:"h-10 flex-1"}),e.jsx(v,{className:"h-10 flex-1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(v,{className:"h-40 rounded-xl"}),e.jsx(v,{className:"h-40 rounded-xl"}),e.jsx(v,{className:"h-40 rounded-xl"})]})]});const M=()=>{h(!1),t(null)},r=n=>{t(n),h(!0)};return e.jsxs("div",{className:"relative pb-20",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search leads...",value:d,onChange:n=>j(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"})]}),e.jsxs("button",{onClick:$,className:"relative p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(pe,{className:`w-4 h-4 transition-colors ${S?"text-blue-600":"text-gray-600"}`}),S&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-blue-600 rounded-full border-2 border-white"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:["all","warm","qualified","appointment_booked"].map(n=>e.jsx("button",{onClick:()=>_(n),className:`flex-1 py-2 px-3 text-xs font-medium rounded-md transition-all ${f===n?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:n==="appointment_booked"?"Appointment":n.charAt(0).toUpperCase()+n.slice(1)},n))})]}),e.jsx("div",{className:"space-y-4",children:w.length>0?w.map(n=>e.jsx(_e,{lead:n,onEdit:r},n.id)):e.jsx(de,{icon:e.jsx(oe,{className:"w-12 h-12 text-gray-300"}),title:"No Leads Found",message:"Try adjusting your search or filters, or add a new lead."})})]}),e.jsx("button",{onClick:()=>{t(null),h(!0)},className:"fixed bottom-20 right-5 z-30 w-14 h-14 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-lg hover:bg-blue-700 transition-all active:scale-90","aria-label":"Add new lead",children:e.jsx(he,{className:"w-7 h-7"})}),(b||i)&&e.jsx(ge,{onClose:M,initialData:i}),e.jsx(Ne,{isOpen:a,onClose:()=>y(!1),filters:A,setFilters:p,onApply:L,onClear:E})]})}export{Fe as default};
