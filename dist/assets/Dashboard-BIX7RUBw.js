import{c as E,j as e,d as D,r as L,b as $,e as F,B as u,U as A,f as M,L as C,g as P,h as p}from"./index-NvUe1ZN8.js";import{u as Y}from"./useSalesCycle-CkNI5cGx.js";import{S as g}from"./SkeletonLoader-DxXA5r8T.js";import{C as B}from"./clock-BVYeTL-p.js";import{C as j}from"./circle-check-big-FIADmbi3.js";import{P as S}from"./plus-DOf-Dc6j.js";import{C as U}from"./calendar-CvnRJtis.js";import{P as G}from"./pen-line-Dgv-gfwV.js";import{T as I}from"./trash-2-GHgWQrqY.js";import{A as z,S as H}from"./star-DSssgxW_.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=E("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=E("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function f({icon:x,title:n,subtitle:i,colorClass:o,onClick:t}){return e.jsxs("button",{onClick:t,className:"flex items-center p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:shadow-sm transition-all duration-200 active:scale-95 text-left w-full",children:[e.jsx("div",{className:`w-10 h-10 ${o} rounded-lg flex items-center justify-center mr-3 flex-shrink-0`,children:x}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-[12px]",children:n}),e.jsx("p",{className:"text-[8px] text-gray-500",children:i})]})]})}const k=({title:x,value:n,color:i,icon:o})=>e.jsxs("div",{className:"rounded-lg shadow-sm overflow-hidden bg-white flex flex-col",children:[e.jsxs("div",{style:{backgroundColor:i},className:"text-white p-3 relative h-20 flex items-center justify-center",children:[e.jsx("div",{className:"absolute -right-1 -bottom-1 opacity-20 text-white",children:o}),e.jsx("p",{className:"text-3xl font-bold",children:n})]}),e.jsx("div",{className:"p-3 flex-grow flex items-center justify-center",children:e.jsx("p",{className:"text-sm text-gray-700 font-medium leading-tight text-center",children:x})})]}),R=()=>{var _,T;const x=$(),{tasks:n}=M(),{showConfirmation:i,addNotification:o}=D(),[t,s]=L.useState(null),h=n.filter(r=>r.status==="pending").slice(0,5),{updateTask:y,deleteTask:w}=M(),N=r=>{s(r)},a=r=>{y.mutate({id:r.id,updates:{status:"completed"}}),s(null)},m=r=>{i("Delete Task?","Are you sure you want to delete this task?",()=>{w.mutate(r.id,{onSuccess:()=>{o("Task Deleted",`"${r.title}" has been removed.`),s(null)}})})},d=()=>{alert("Call functionality would open phone dialer with client number")},l=()=>{alert("WhatsApp functionality would open WhatsApp with client number")},b=()=>{alert("Email functionality would open email client with client address")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center",children:[e.jsx(C,{className:"w-5 h-5 mr-2 text-purple-600"}),"Things to Get Done"]}),n.length>5&&e.jsx("button",{onClick:()=>x("/tasks"),className:"text-sm font-medium text-blue-600 hover:underline",children:"See all"})]}),h.length>0?e.jsx("div",{className:"space-y-3",children:h.map(r=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>N(r),children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:r.title}),e.jsx("p",{className:"text-xs text-gray-500",children:`Due: ${new Date(r.due_date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}`})]}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full whitespace-nowrap ${r.priority==="urgent"?"bg-red-100 text-red-800":r.priority==="high"?"bg-orange-100 text-orange-800":r.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:r.priority})]},r.id))}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(j,{className:"w-8 h-8 mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"All tasks completed!"})]})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Task Details"}),e.jsx("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(t.due_date).toLocaleDateString("en-GB")})]}),t.time&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:t.time})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${t.priority==="urgent"?"bg-red-100 text-red-800":t.priority==="high"?"bg-orange-100 text-orange-800":t.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:((_=t.priority)==null?void 0:_.toUpperCase())||"LOW"}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${t.status==="completed"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:((T=t.status)==null?void 0:T.toUpperCase())||"PENDING"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>a(t),className:"flex items-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 transition-colors",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:"Complete"})]}),e.jsxs("button",{onClick:()=>x("/tasks",{state:{editTask:t}}),className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>m(t),className:"flex items-center space-x-2 px-3 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 transition-colors",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Delete"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[e.jsxs("button",{onClick:d,className:"flex items-center space-x-2 px-3 py-2 bg-gray-600 text-white rounded-lg text-sm hover:bg-gray-700 transition-colors",children:["ðŸ“ž ",e.jsx("span",{children:"Call"})]}),e.jsxs("button",{onClick:l,className:"flex items-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 transition-colors",children:["ðŸ’¬ ",e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 transition-colors",children:["âœ‰ï¸ ",e.jsx("span",{children:"Email"})]})]})]})]})})]})},Q=()=>{const{clients:x}=P(),n=[],i=new Date;i.setHours(0,0,0,0);const o=new Date;o.setDate(i.getDate()+7),x.forEach(s=>{if(s.dob){const c=new Date(s.dob);c.setFullYear(i.getFullYear()),c>=i&&c<=o&&n.push({id:`b-${s.id}`,type:"Birthday",date:c,clientName:s.full_name,years:null})}if(s.client_since){const c=new Date(s.client_since),h=i.getFullYear()-c.getFullYear();c.setFullYear(i.getFullYear()),c>=i&&c<=o&&h>0&&n.push({id:`a-${s.id}`,type:"Anniversary",date:c,clientName:s.full_name,years:h})}});const t=n.sort((s,c)=>s.date.getTime()-c.date.getTime());return e.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2 text-orange-600"}),"Upcoming Events"]}),t.length>0?e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${s.type==="Birthday"?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"}`,children:s.type==="Birthday"?e.jsx(W,{className:"w-4 h-4"}):e.jsx(H,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.clientName}),e.jsx("p",{className:"text-xs text-gray-500",children:s.type==="Anniversary"?`${s.years} Year Anniversary`:"Birthday"})]}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:s.date.toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},s.id))}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(U,{className:"w-8 h-8 mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No upcoming events."})]})]})};function ae(){const{setTitle:x}=D();L.useEffect(()=>{x("Dashboard")},[x]);const n=$(),{activities:i}=D(),{deals:o,isLoading:t}=F(),{salesCycle:s}=Y(),c=o.filter(a=>!["completed","unsuccessful"].includes(a.stage||"")).length,h=s&&s.end_date?(()=>{const a=new Date,m=new Date(s.end_date);a.setHours(0,0,0,0),m.setHours(0,0,0,0);const d=m.getTime()-a.getTime(),l=Math.ceil(d/(1e3*60*60*24));return Math.max(0,l)})():0,y=o.filter(a=>a.stage==="completed").length,w=a=>{const m=new Date(a),d=Math.floor((new Date().getTime()-m.getTime())/1e3);let l=d/31536e3;return l>1?Math.floor(l)+"y ago":(l=d/2592e3,l>1?Math.floor(l)+"mo ago":(l=d/86400,l>1?Math.floor(l)+"d ago":(l=d/3600,l>1?Math.floor(l)+"h ago":(l=d/60,l>1?Math.floor(l)+"m ago":d<10?"just now":Math.floor(d)+"s ago"))))},N=a=>{const m={lead_add:e.jsx(p,{className:"w-4 h-4 text-white"}),lead_update:e.jsx(p,{className:"w-4 h-4 text-white"}),lead_delete:e.jsx(p,{className:"w-4 h-4 text-white"}),lead_convert:e.jsx(p,{className:"w-4 h-4 text-white"}),client_add:e.jsx(A,{className:"w-4 h-4 text-white"}),deal_add:e.jsx(u,{className:"w-4 h-4 text-white"}),deal_stage_update:e.jsx(u,{className:"w-4 h-4 text-white"}),deal_delete:e.jsx(u,{className:"w-4 h-4 text-white"}),task_add:e.jsx(C,{className:"w-4 h-4 text-white"}),task_complete:e.jsx(j,{className:"w-4 h-4 text-white"})},d={lead_add:"bg-green-500",lead_update:"bg-blue-500",lead_delete:"bg-red-500",lead_convert:"bg-purple-500",client_add:"bg-indigo-500",deal_add:"bg-green-500",deal_stage_update:"bg-blue-500",deal_delete:"bg-red-500",task_add:"bg-yellow-500",task_complete:"bg-green-500"};return e.jsx("div",{className:`w-8 h-8 ${d[a]||"bg-gray-500"} rounded-full flex items-center justify-center flex-shrink-0`,children:m[a]})};return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(g,{className:"h-28 rounded-lg"}),e.jsx(g,{className:"h-28 rounded-lg"}),e.jsx(g,{className:"h-28 rounded-lg"})]}),e.jsx(g,{className:"h-48 rounded-xl"}),e.jsx(g,{className:"h-40 rounded-xl"}),e.jsx(g,{className:"h-40 rounded-xl"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(k,{title:"Deals Processing",value:c,color:"#5d5dff",icon:e.jsx(u,{size:56})}),e.jsx(k,{title:"Days Remaining",value:h,color:"#ff5d5d",icon:e.jsx(B,{size:56})}),e.jsx(k,{title:"Done Successfully",value:y,color:"#5dff5d",icon:e.jsx(j,{size:56})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2 text-blue-600"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(f,{onClick:()=>n("/leads",{state:{showAddModal:!0}}),icon:e.jsx(S,{className:"w-6 h-6 text-white"}),title:"New Lead",subtitle:"Add Prospect",colorClass:"bg-blue-500"}),e.jsx(f,{onClick:()=>n("/tasks",{state:{showAddModal:!0}}),icon:e.jsx(S,{className:"w-6 h-6 text-white"}),title:"Add Task",subtitle:"New Task",colorClass:"bg-green-500"}),e.jsx(f,{onClick:()=>n("/clients",{state:{showAddModal:!0}}),icon:e.jsx(A,{className:"w-6 h-6 text-white"}),title:"Add Client",subtitle:"New Account",colorClass:"bg-purple-500"}),e.jsx(f,{onClick:()=>n("/deals",{state:{showAddModal:!0}}),icon:e.jsx(u,{className:"w-6 h-6 text-white"}),title:"New Deal",subtitle:"Add Journey",colorClass:"bg-orange-500"})]})]}),e.jsx(R,{}),e.jsx(Q,{}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2 text-green-600"}),"Recent Activity"]}),i.length>0?e.jsx("div",{className:"space-y-4",children:i.filter(a=>{const m=new Date(a.timestamp),l=(new Date().getTime()-m.getTime())/(1e3*60*60),b=["lead_convert","deal_stage_update","task_complete"];return l<=24&&b.includes(a.type)}).slice(0,5).map(a=>e.jsxs("div",{className:"flex items-center space-x-3",children:[N(a.type),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.message})}),e.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:w(a.timestamp)})]},a.id))}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(v,{className:"w-8 h-8 mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your recent activities will show up here."})]})]})]})}export{ae as default};
