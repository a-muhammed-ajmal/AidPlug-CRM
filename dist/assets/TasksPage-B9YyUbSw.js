import{d as k,g as v,a as E,e as T,r as m,j as e,X as _,R as A,C as M,S as b,L as I}from"./index-XESJNA6v.js";import{E as L}from"./EmptyState-BRjS5MyD.js";import{C as P}from"./chevron-down-Cc4qbPYb.js";import{D as U,a as C,P as $,E as F}from"./DropdownMenu-QKL23TpE.js";import{T as O}from"./trash-2-BWGgcqO4.js";import{C as R}from"./calendar-BI42gCrQ.js";import{C as V}from"./clock-DaW7saYn.js";import{P as q}from"./plus-Dfe9gStt.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=k("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),f=({label:s,children:t})=>e.jsxs("div",{children:[e.jsx("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:s}),t]}),S=({id:s,name:t,value:x,onChange:p,options:c,required:a})=>e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:s,name:t,value:x,onChange:p,required:a,className:"w-full appearance-none bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-3 pr-10",children:c.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))}),e.jsx(P,{className:"w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"})]});function B({onClose:s,initialData:t}){const{createTask:x,updateTask:p}=v(),{user:c}=E(),{addNotification:a}=T(),[o,d]=m.useState(!1),g=t?"edit":"add",[l,h]=m.useState({title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",type:(t==null?void 0:t.type)||"call",priority:(t==null?void 0:t.priority)||"medium",due_date:t!=null&&t.due_date?t.due_date.split("T")[0]:new Date().toISOString().split("T")[0],time:(t==null?void 0:t.time)||""}),n=j=>{const{name:r,value:u}=j.target;h(N=>({...N,[r]:u}))},y=async j=>{if(j.preventDefault(),!c){a("Authentication Error","You must be logged in.");return}d(!0);const r={title:l.title,description:l.description,type:l.type,priority:l.priority,due_date:l.due_date,time:l.time||null,user_id:c.id};if(g==="add"){const u={...r,status:"pending",estimated_duration:null,related_to_id:null,related_to_type:null};x.mutate(u,{onSuccess:()=>{a("Task Created",`"${l.title}" has been added.`),s()},onError:N=>a("Error",N.message),onSettled:()=>d(!1)})}else t&&p.mutate({id:t.id,updates:r},{onSuccess:()=>{a("Task Updated",`"${l.title}" has been saved.`),s()},onError:u=>a("Error",u.message),onSettled:()=>d(!1)})},i=[{value:"call",label:"ðŸ“ž Call"},{value:"meeting",label:"ðŸ‘¥ Meeting"},{value:"documentation",label:"ðŸ“„ Documentation"},{value:"verification",label:"âœ“ Verification"},{value:"follow_up",label:"ðŸ”„ Follow Up"}],w=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"urgent",label:"Urgent"}];return e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex justify-center items-end animate-fade-in sm:items-center",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-t-2xl sm:rounded-2xl shadow-xl transform transition-transform animate-slide-up flex flex-col max-h-[90vh]",children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:g==="add"?"Add New Task":"Edit Task"}),e.jsx("button",{onClick:s,className:"p-2 -mr-2 rounded-full hover:bg-gray-100",children:e.jsx(_,{className:"w-5 h-5 text-gray-600"})})]}),e.jsxs("form",{onSubmit:y,className:"flex-1 flex flex-col min-h-0",children:[e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(f,{label:"Task Title*",children:e.jsx("input",{type:"text",name:"title",value:l.title,onChange:n,required:!0,className:"w-full bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-3"})}),e.jsx(f,{label:"Description",children:e.jsx("textarea",{name:"description",value:l.description,onChange:n,rows:3,className:"w-full bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-3"})}),e.jsx(f,{label:"Task Type",children:e.jsx(S,{id:"type",name:"type",value:l.type,onChange:n,options:i})}),e.jsx(f,{label:"Priority",children:e.jsx(S,{id:"priority",name:"priority",value:l.priority,onChange:n,options:w})}),e.jsx(f,{label:"Due Date*",children:e.jsx("input",{type:"date",name:"due_date",value:l.due_date,onChange:n,required:!0,className:"w-full bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-3"})}),e.jsx(f,{label:"Time (Optional)",children:e.jsx("input",{type:"time",name:"time",value:l.time,onChange:n,className:"w-full bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-3"})})]})}),e.jsx("footer",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:e.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 px-4 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all active:scale-95 shadow disabled:opacity-50",children:o?"Saving...":g==="add"?"Save Task":"Update Task"})})]})]})})}const G=A.memo(({task:s,onEdit:t})=>{const{updateTask:x,deleteTask:p}=v(),{showConfirmation:c,addNotification:a}=T(),o={urgent:"border-red-300",high:"border-orange-300",medium:"border-yellow-300",low:"border-green-300"},d={urgent:"bg-red-100 text-red-700",high:"bg-orange-100 text-orange-700",medium:"bg-yellow-100 text-yellow-700",low:"bg-green-100 text-green-700"},g={call:"ðŸ“ž",meeting:"ðŸ‘¥",documentation:"ðŸ“„",verification:"âœ“",follow_up:"ðŸ”„"},l=new Date().toISOString().split("T")[0],h=s.due_date<l&&s.status==="pending",n=new Date(s.due_date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),y=()=>{c("Delete Task?","Are you sure you want to delete this task? This action cannot be undone.",()=>{p.mutate(s.id,{onSuccess:()=>a("Task Deleted",`"${s.title}" has been removed.`),onError:i=>a("Error",i.message||"Failed to delete task.")})})};return e.jsx("div",{className:`bg-white rounded-xl shadow-sm p-4 border-l-4 ${o[s.priority||"low"]}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("button",{onClick:()=>x.mutate({id:s.id,updates:{status:s.status==="completed"?"pending":"completed"}}),className:"mt-1 flex-shrink-0",children:s.status==="completed"?e.jsx(M,{className:"w-6 h-6 text-green-600"}):e.jsx(z,{className:"w-6 h-6 text-gray-400 hover:text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("h3",{className:`font-semibold text-gray-800 break-words pr-2 ${s.status==="completed"?"line-through text-gray-500":""}`,children:[g[s.type||"call"]," ",s.title]}),e.jsx(U,{trigger:e.jsx(F,{className:"w-4 h-4 text-gray-500"}),children:e.jsxs(e.Fragment,{children:[e.jsx(C,{onClick:i=>{i.stopPropagation(),t(s)},icon:e.jsx($,{className:"w-4 h-4 mr-2"}),children:"Edit"}),e.jsx(C,{onClick:i=>{i.stopPropagation(),y()},icon:e.jsx(O,{className:"w-4 h-4 mr-2"}),className:"text-red-600",children:"Delete"})]})})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 break-words",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsxs("div",{className:`flex items-center space-x-1 text-xs px-2 py-1 rounded ${h?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:[e.jsx(R,{className:"w-3 h-3"}),e.jsx("span",{children:n}),h&&e.jsx("span",{className:"font-semibold ml-1",children:"OVERDUE"})]}),s.time&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:[e.jsx(V,{className:"w-3 h-3"}),e.jsx("span",{children:s.time})]}),s.priority&&e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${d[s.priority]}`,children:s.priority.toUpperCase()})]})]})]})})});function D(){const{setTitle:s}=T();m.useEffect(()=>{s("Tasks")},[s]);const{tasks:t,isLoading:x}=v(),[p,c]=m.useState(!1),[a,o]=m.useState(null),[d,g]=m.useState("all"),l=new Date().toISOString().split("T")[0],h=m.useMemo(()=>t.filter(r=>d==="today"?r.due_date===l:d==="pending"?r.status==="pending":d==="completed"?r.status==="completed":!0),[t,d,l]),n=m.useMemo(()=>[...h].sort((r,u)=>r.status!==u.status?r.status==="pending"?-1:1:new Date(r.due_date).getTime()-new Date(u.due_date).getTime()),[h]);if(x)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(b,{className:"h-10 flex-1"}),e.jsx(b,{className:"h-10 flex-1"}),e.jsx(b,{className:"h-10 flex-1"}),e.jsx(b,{className:"h-10 flex-1"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(b,{className:"h-28 rounded-xl"}),e.jsx(b,{className:"h-28 rounded-xl"}),e.jsx(b,{className:"h-28 rounded-xl"})]})]});const y=r=>{o(r),c(!0)},i=()=>{c(!1),o(null)},w=()=>{o(null),c(!0)},j=["all","today","pending","completed"];return e.jsxs("div",{className:"relative pb-20",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:j.map(r=>e.jsx("button",{onClick:()=>g(r),className:`flex-1 py-2 px-3 text-xs font-medium rounded-md transition-all ${d===r?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:r.charAt(0).toUpperCase()+r.slice(1)},r))})}),e.jsx("div",{className:"space-y-3",children:n.length>0?n.map(r=>e.jsx(G,{task:r,onEdit:y},r.id)):e.jsx(L,{icon:e.jsx(I,{className:"w-12 h-12 text-gray-300"}),title:"No Tasks Found",message:d==="all"?"Add your first task to get started.":"Try adjusting your filter."})})]}),e.jsx("button",{onClick:w,className:"fixed bottom-20 right-5 z-30 w-14 h-14 bg-blue-600 text-white rounded-full flex items-center justify-center shadow-lg hover:bg-blue-700 transition-all active:scale-90","aria-label":"Add new task",children:e.jsx(q,{className:"w-7 h-7"})}),p&&e.jsx(B,{onClose:i,initialData:a})]})}export{D as default};
